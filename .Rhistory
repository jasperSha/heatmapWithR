install.packages(c("arrow", "devtools", "feather"))
devtools::install_github("dkahle/ggmap", ref="tidyup", force=TRUE)
google_cloud_key = 'AIzaSyBwyTFb6dI_pn0KDKRfilLTuhg0fVEeiqo'
library("ggmap")
ggmap::register_google(google_cloud_key)
Sys.getenv('R_HOME')
#accessing r environ
R.home()
mapbox_key <- Sys.getenv("MAPBOX_API")
#GOOGLE_CLOUD_API
#MAPBOX_API
google_cloud_key <- Sys.getenv("GOOGLE_CLOUD_API")
Sys.getenv('R_HOME')
ggmap::register_google(google_cloud_key)
library(ggmap)
ggmap::register_google(google_cloud_key)
crime_2019 <- sf::st_read('2019_crime.gpkg')
library(sf)
crime_2019 <- sf::st_read('2019_crime.gpkg')
setwd("~/Documents/HousingMap/R_data/")
crime_2019 <- sf::st_read('2019_crime.gpkg')
#split POINT into long/lat for heatmap considerations
crime_2019 <- geoconvert::geom_to_lonlat(crime_2019)
severe_crimes <- c("HOMICIDE", "AGGRAVATED", "SEXUAL", "FORCIBLE", "RAPE", "CHILD ABUSE")
worst_crime_2019 <- filter(crime_2019, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
View(crime_2019)
worst_crime_2019 <- filter(crime_2019, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
library(dplyr)
worst_crime_2019 <- filter(crime_2019, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
View(crime_2019)
View(worst_crime_2019)
#list of every unique crime code
crime_codes <- data.frame(unique(crime_2019$crm_cd_desc))
View(crime_codes)
rest_crimes <- setdiff(worst_crime_2019$crm_cd_desc, crime_2019$crm_cd_desc)
rest_crimes <- (crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc])
rest_crimes <- data.frame((crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc]))
rest_crimes <- data.frame(unique(crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc]))
View(rest_crimes)
severe_crimes <- c("HOMICIDE", "AGGRAVATED", "SEXUAL", "FORCIBLE", "RAPE", "CHILD ABUSE", "BURGLARY", "FELONY", "HUMAN TRAFFICKIGN", "LYNCHING")
#require dplyr for filter
worst_crime_2019 <- filter(crime_2019, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
rest_crimes <- data.frame(unique(crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc]))
View(worst_crime_2019)
library(leaflet)
library(leaflet.extras)
crime_map <- leaflet(worst_crime_2019) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=1000)
crime_map
#fitbounds(lng1, lat1, lng2, lat2)
crime_map %>% fitBounds(~min(long), ~min(lat), ~max(long), ~max(lat))
crime_map <- leaflet(worst_crime_2019) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=10)
crime_map
crime_map <- leaflet(worst_crime_2019) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=250)
crime_map
#fitbounds(lng1, lat1, lng2, lat2)
crime_map %>% fitBounds(~min(lon), ~min(lat), ~max(lon), ~max(lat))
crime_map
crime_2018 <- sf::st_read('2018_crime.gpkg')
#split POINT into long/lat for heatmap considerations
crime_2018 <- geoconvert::geom_to_lonlat(crime_2018)
#require dplyr for filter
worst_crime_2018 <- filter(crime_2018, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
rest_crimes_2019 <- data.frame(unique(crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc]))
rest_crimes_2018 <- data.frame(unique(crime_2018$crm_cd_desc[!crime_2018$crm_cd_desc %in% worst_crime_2018$crm_cd_desc]))
View(rest_crimes_2018)
View(rest_crimes_2018)
View(rest_crimes_2019)
View(rest_crimes_2018)
severe_crimes <- c("HOMICIDE", "AGGRAVATED", "SEXUAL", "FORCIBLE", "RAPE", "CHILD ABUSE", "BURGLARY", "FELONY", "HUMAN TRAFFICKIGN", "LYNCHING", "GRAND")
#require dplyr for filter
worst_crime_2018 <- filter(crime_2018, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
worst_crime_2019 <- filter(crime_2019, grepl(paste(severe_crimes, collapse="|"), crm_cd_desc))
rest_crimes_2018 <- data.frame(unique(crime_2018$crm_cd_desc[!crime_2018$crm_cd_desc %in% worst_crime_2018$crm_cd_desc]))
rest_crimes_2019 <- data.frame(unique(crime_2019$crm_cd_desc[!crime_2019$crm_cd_desc %in% worst_crime_2019$crm_cd_desc]))
View(worst_crime_2018)
crime_map <- leaflet(worst_crime_2018) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=250)
#fitbounds(lng1, lat1, lng2, lat2)
crime_map %>% fitBounds(~min(worst_crime_2018$lon), ~min(worst_crime_2018$lat), ~max(worst_crime_2018$lon), ~max(worst_crime_2018$lat))
crime_map
library(dplyr)
library(sf)
library(rgdal)
library(dplyr)
library(sf)
library(rgdal)
#city boundaries to pass to main heatmap layer, using the
#average of each city bounds from the rentindex
#to provide the zero'th index of the heat temperature
setwd("~/Documents/HousingMap/R_data/City_Boundaries/")
getwd()
property_data <- sf::st_read("property.gpkg")
setwd("~/Documents/HousingMap/R_data/")
#zillow data
property_data <- sf::st_read("property.gpkg")
View(property_data)
property_data <- geoconvert::geom_to_lonlat(property_data)
View(property_data)
crime_map <- leaflet(property_data) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=250)
crime_map
crime_map <- leaflet(property_data) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=1000)
crime_map
ridzip <- read.csv(file= 'ZRI_by_zipcode.csv')
View(ridzip)
#only rent index of Los Angeles County
la_county_rentindex <- ridzip %>% filter(ridzip$County=='Los Angeles County')
View(la_county_rentindex)
neighborhood_zri <- read.csv(file='Neighborhood_Zhvi_AllHomes.csv')
View(neighborhood_zri)
la_neighborhood_rentindex <- neighborhood_zri %>% filter(nneighborhood_zri$City=='Los Angeles')
la_neighborhood_rentindex <- neighborhood_zri %>% filter(neighborhood_zri$City=='Los Angeles')
View(la_neighborhood_rentindex)
crime_map
crime_map <- leaflet(property_data) %>%
addProviderTiles(providers$CartoDB.DarkMatter)%>%
addWebGLHeatmap(lng=~lon, lat=~lat, size=500)
crime_map
#city boundaries to pass to main heatmap layer, using the
#average of each city bounds from the rentindex
#to provide the zero'th index of the heat temperature
setwd("~/Documents/HousingMap/R_data/City_Boundaries/")
city_boundaries.shape <- readOGR(dsn=getwd(), layer='City_Boundaries')
View(city_boundaries.shape)
city_bounds <- sf::st_read('City_Boundaries.shp')
cities <- data.frame(unique(city_bounds$CITY_NAME))
View(cities)
city_bounds <- data.frame(sf::st_read('City_Boundaries.shp'))
View(city_bounds)
cities <- data.frame(unique(city_bounds$CITY_NAME))
View(cities)
View(city_bounds)
cities <- data.frame(unique(city_bounds$CITY_NAME), city_bounds$ShapeSTAre, city_bounds$ShapeSTLen)
plot(city_bounds)
plot(city_bounds.shape)
plot(city_boundaries.shape)
View(city_bounds)
typeof(cities)
unique_city_bounds <- city_bounds[!duplicated(city_bounds[,c('CITY_NAME', 'ShapeSTAre', 'ShapeSTLen')]),]
View(unique_city_bounds)
unique_city_bounds <- city_bounds[!duplicated(city_bounds[,c('CITY_NAME')]),]
View(unique_city_bounds)
unique_city_bounds <- c(unique_city_bounds$CITY_NAME, unique_city_bounds$ShapeSTAre, unique_city_bounds$ShapeSTLen)
unique_city_bounds <- data.frame(c(unique_city_bounds$CITY_NAME, unique_city_bounds$ShapeSTAre, unique_city_bounds$ShapeSTLen)
unique_city_bounds <- data.frame(c(unique_city_bounds$CITY_NAME,
unique_city_bounds$ShapeSTAre, unique_city_bounds$ShapeSTLen))
unique_city_bounds <- data.frame(c(unique_city_bounds$CITY_NAME, unique_city_bounds$ShapeSTAre, unique_city_bounds$ShapeSTLen))
unique_city_bounds <- as_tibble(c(unique_city_bounds$CITY_NAME, unique_city_bounds$ShapeSTAre, unique_city_bounds$ShapeSTLen))
unique_city_bounds <- city_bounds[!duplicated(city_bounds[,c('CITY_NAME')]),]
View(city_boundaries.shape)
city_boundaries.shape <- readOGR(dsn=getwd(), layer='City_Boundaries')
View(city_boundaries.shape)
setwd("~/Documents/HousingMap/R_data/")
neighborhood_zri <- read.csv(file='Neighborhood_Zhvi_AllHomes.csv')
View(neighborhood_zri)
most_recent_hood_zri <- neighborhood_zri$X2020.01
most_recent_hood_zri <- data.frame(neighborhood_zri$X2020.01)
View(most_recent_hood_zri)
most_recent_hood_zri <- data.frame(neighborhood_zri$City, neighborhood_zri$X2020.01)
View(most_recent_hood_zri)
most_recent_hood_zri <- data.frame(neighborhood_zri$CountyName, neighborhood_zri$X2020.01)
View(neighborhood_zri)
View(most_recent_hood_zri)
View(neighborhood_zri)
hood_zri <- read.csv(file='Neighborhood_Zhvi_AllHomes.csv')
most_recent_hood_zri <- data.frame(hood_zri$City, hood_zri$CountyName, hood_zri$X2020.01)
View(most_recent_hood_zri)
hood_zri <- filter(hood_zri, CountyName=='Los Angeles County')
View(hood_zri)
View(city_boundaries.shape)
View(hood_zri)
hood_zri <- filter(hood_zri, CountyName=='Los Angeles County')
hood_zri <- hood_zri[c(hood_zri$City, hood_zri$CountyName, hood_zri$X2020.01)]
View(hood_zri)
setwd("~/Documents/HousingMap/R_data/")
hood_zri <- read.csv(file='Neighborhood_Zhvi_AllHomes.csv')
